--[[
@author Lukasz Biegaj <wielebny@lss-rp.pl>
@author Karer <karer.programmer@gmail.com>
@author WUBE <wube@lss-rp.pl>
@copyright 2011-2013 Lukasz Biegaj <wielebny@lss-rp.pl>
@license GPLv2
@package MTA-XyzzyRP
@link https://github.com/lpiob/MTA-XyzzyRP GitHub
]]--



local polozenia={

-- port
{2645.3, -2342.2, 12.63},
{2554.2, -2471.0, 13.46},
{2568.6, -2429.4, 13.46},
{2607.8, -2457.1, 12.62},
{2590.1, -2466.7, 2.20},
{2607.0, -2445.4, 12.63},
{2537.7, -2453.4, 12.62},
{2606.4, -2421.6, 12.64},
{2602.9, -2399.9, 12.51},
{2611.2, -2436.7, 12.63},
{2563.9, -2443.6, 13.46},
{2606.4, -2432.4, 12.63},
{2545.2, -2484.7, 12.64},
{2551.1, -2491.3, 12.65},
{2616.3, -2336.3, 12.62},
{2604.0, -2416.7, 12.63},
{2565.8, -2442.9, 13.46},
{2654.7, -2406.7, 12.52},
{2622.0, -2334.4, 12.63},
{2571.2, -2511.1, 12.66},
{2611.0, -2409.0, 12.46},
{2512.8, -2410.9, 13.46},
{2506.6, -2450.0, 13.46},
{2625.3, -2371.4, 13.46},
{2634.2, -2473.8, 1.21},
{2593.8, -2420.7, 12.47},
{2697.6, -2417.0, 12.63},
{2636.2, -2425.4, 13.46},
{2571.9, -2352.0, 12.63},
{2621.3, -2445.2, 12.63},
{2598.2, -2422.6, 12.47},
{2619.6, -2465.8, 13.17},
{2525.1, -2387.9, 12.63},
{2608.8, -2401.4, 12.53},
{2548.7, -2366.8, 12.73},
{2547.7, -2441.4, 13.46},
{2619.0, -2466.2, 2.00},
{2659.6, -2378.9, 13.46},
{2680.3, -2450.2, 12.50},
{2601.6, -2417.0, 12.64},
{2689.6, -2417.2, 12.63},
{2580.7, -2428.3, 12.64},
{2626.5, -2431.0, 12.63},
{2641.4, -2372.8, 13.46},
{2508.6, -2430.2, 12.62},
{2667.4, -2418.0, 13.46},
{2616.7, -2439.0, 13.46},
{2554.4, -2365.1, 0.64},
{2635.1, -2463.3, 2.00},
{2620.3, -2341.2, 12.63},
{2597.0, -2372.7, 12.56},
{2561.7, -2427.8, 13.46},
{2572.5, -2447.4, 12.63},
{2665.1, -2452.3, 12.63},
{2582.7, -2408.8, 12.47},
{2629.9, -2420.4, 12.63},
{2557.1, -2390.1, 12.47},
{2624.0, -2357.9, 13.46},
{2604.0, -2449.9, 12.62},
{2556.2, -2453.3, 13.46},
{2579.2, -2411.8, 12.47},
{2554.8, -2486.6, 12.64},
{2536.1, -2477.3, 12.64},
{2585.6, -2429.7, 12.64},
{2583.3, -2451.7, 12.62},
{2601.1, -2426.3, 12.47},
{2600.4, -2379.7, 12.54},
{2626.3, -2444.5, 12.63},
{2665.3, -2406.3, 12.49},
{2597.6, -2435.5, 12.64},
{2604.0, -2416.7, 12.63},
{2545.9, -2442.7, 13.46},
{2637.4, -2350.5, 13.46},
{2597.5, -2425.7, 12.47},
{2528.2, -2466.6, 12.63},
{2592.0, -2497.3, 12.66},
{2618.1, -2462.0, 12.33},
{2563.6, -2431.4, 13.46},
{2668.6, -2483.9, 12.65},
{2598.1, -2376.6, 12.50},
{2579.2, -2449.5, 12.62},
{2573.6, -2450.7, 12.63},
{2574.2, -2347.1, 12.63},
{2600.6, -2435.2, 12.64},
{2638.9, -2469.4, 2.00},
{2528.6, -2429.1, 13.46},
{2544.8, -2472.3, 13.46},
{2631.0, -2443.8, 12.63},
{2520.6, -2427.5, 13.46},
{2554.1, -2423.7, 13.46},
{2629.4, -2379.2, 13.46},
{2602.0, -2435.5, 12.63},
{2567.0, -2382.0, 13.08},
{2544.7, -2404.2, 13.46},
{2583.9, -2453.3, 12.62},


-- plaza kolo portu
{2889.1, -2150.9, 2.89},
{2879.9, -2125.4, 3.39},
{2903.7, -2126.0, 1.83},
{2896.4, -2157.4, 1.53},
{2896.2, -2136.8, 2.34},
{2904.8, -2057.5, 1.25},
{2893.6, -2118.1, 2.30},
{2880.3, -2184.1, 1.67},
{2894.5, -2127.5, 2.22},
{2907.7, -2117.1, 1.47},
{2884.5, -2145.1, 2.97},
{2899.8, -2146.1, 1.63},
{2895.4, -2097.4, 1.43},
{2891.2, -2113.9, 2.58},
{2875.5, -2133.8, 3.38},
{2878.6, -2142.8, 3.02},
{2896.9, -2083.4, 1.95},
{2889.9, -2171.9, 0.69},
{2888.8, -2106.0, 2.09},
{2915.3, -2107.1, 0.18},
{2860.4, -2168.0, 2.37},
{2872.1, -2158.6, 1.90},
{2909.1, -2110.3, 1.32},
{2887.8, -2134.6, 2.63},
{2885.5, -2163.6, 2.74},
{2855.4, -2179.0, 3.26},
{2901.5, -2079.3, 1.27},

-- grove street
{ 2508.0, -1739.0, 12.55},
{ 2487.0, -1725.3, 12.55},
{2475.5, -1633.9, 12.41},
{ 2503.0, -1728.3, 12.38},
{ 2447.0, -1659.7, 12.30},
{ 2578.0, -1618.6, 2.27},
{2475.7, -1682.6, 12.39},
{2502.7, -1665.4, 12.37},
{ 2472.1, -1673.1, 12.33},
{ 2426.6, -1646.6, 12.52},
{ 2503.0, -1675.2, 12.36},
{2591.0, -1657.2, 1.16},
{ 2589.4, -1698.7, 0.64},
{ 2506.7, -1681.3, 12.55},
{2527.0, -1742.0, 12.38},
{ 2495.4, -1646.2, 12.53},
{2499.9, -1662.6, 12.36},
{2449.9, -1698.1, 13.36},
{2566.0, -1650.7, 1.32},
{2424.2, -1626.9, 12.26},
{2475.1, -1647.9, 12.47},
{2505.7, -1713.1, 12.54},
{2550.7, -1738.7, 12.55},
{2466.1, -1690.3, 12.51},
{2558.0, -1707.0, 0.64},
{ 2533.5, -1706.5, 12.38},
{ 2518.3, -1766.9, 12.55},
{2467.0, -1679.0, 12.51},
{2444.4, -1732.9, 12.57},
{ 2541.8, -1686.4, 11.59},
{ 2470.0, -1640.1, 13.36},
{2447.9, -1706.4, 12.51},
{ 2520.0, -1706.0, 12.41},
{ 2450.0, -1669.1, 12.49},
{2460.5, -1696.4, 13.36},
{2504.7, -1680.9, 12.55},
{2491.1, -1668.6, 12.34},
{ 2482.2, -1685.6, 12.51},
{ 2494.6, -1665.2, 12.34},
{ 2592.3, -1640.9, 1.54},
{2474.5, -1728.1, 12.38},
{2584.8, -1693.2, 0.64},
{ 2466.9, -1684.9, 12.52},
{2546.8, -1614.0, 8.81},
{2468.6, -1680.8, 12.51},
{2485.7, -1660.5, 12.34},
{ 2484.4, -1633.2, 12.45},
{2550.8, -1588.8, 8.15},
{ 2493.9, -1666.2, 12.34},
{2503.7, -1663.5, 12.39},
{2503.4, -1686.2, 12.55},
{2447.5, -1711.0, 12.73},
{ 2509.2, -1675.6, 12.55},
{ 2518.8, -1707.7, 12.43},
{2503.8, -1664.6, 12.38},
{ 2500.4, -1690.2, 12.55},
{ 2544.6, -1722.0, 12.55},
{ 2467.3, -1657.3, 12.30},
{2528.0, -1687.1, 12.87},
{ 2507.9, -1671.2, 12.38},
{ 2477.6, -1679.4, 12.34},
{ 2517.9, -1668.7, 13.18},
{ 2483.0, -1642.1, 12.45},
{2437.9, -1659.1, 12.36},
{ 2560.0, -1717.8, 0.64},
{ 2523.5, -1701.6, 13.36},
{ 2414.7, -1696.1, 12.69},
{2519.3, -1637.6, 13.36},
{2546.0, -1720.8, 12.55},
{2503.6, -1639.3, 12.50},
{ 2425.0, -1612.8, 12.16},
{ 2586.1, -1699.3, 0.64},
{ 2511.4, -1646.1, 13.36},
{ 2498.4, -1680.7, 12.36},
{ 2469.1, -1679.1, 12.51},
{2531.1, -1758.6, 12.38},
{2562.4, -1624.3, 2.07},
{2544.7, -1621.3, 10.02},
{ 2521.2, -1699.5, 13.36},
{2509.4, -1677.0, 12.55},
{2488.2, -1724.6, 12.55},
{2489.7, -1663.5, 12.34},
{2547.9, -1670.9, 5.74},
{2510.8, -1679.8, 12.55},
{ 2467.0, -1703.3, 13.36},
{2553.6, -1632.5, 1.89},
{ 2459.1, -1631.2, 12.40},
{ 2496.2, -1666.3, 12.34},
{ 2511.3, -1745.7, 13.36},
{2493.9, -1739.8, 12.55},
{ 2569.8, -1682.7, 0.64},

-- plaza santa maria beach, 200 obiektow

{ 300.4, -1777.2, 3.47},
{ 197.5, -1880.6, 0.88},
{ 211.0, -1882.9, 0.59},
{162.3, -1811.4, 3.34},
{165.3, -1848.9, 2.57},
{205.8, -1729.4, 3.42},
{148.0, -1773.7, 3.42},
{302.9, -1877.7, 1.37},
{ 186.3, -1856.1, 2.30},
{ 255.4, -1801.1, 3.41},
{222.7, -1814.0, 3.33},
{227.7, -1844.2, 2.44},
{158.6, -1837.4, 2.77},
{ 215.3, -1841.4, 2.56},
{ 249.8, -1821.4, 3.02},
{ 154.2, -1749.2, 4.07},
{213.5, -1833.6, 2.80},
{191.8, -1826.0, 3.12},
{ 238.1, -1856.1, 2.08},
{273.4, -1825.5, 2.92},
{218.3, -1831.8, 2.82},
{238.4, -1767.1, 3.51},
{ 197.1, -1877.1, 1.19},
{151.6, -1852.7, 2.77},
{244.3, -1828.9, 2.81},
{243.4, -1850.5, 2.22},
{309.2, -1806.8, 3.45},
{ 222.1, -1824.8, 3.01},
{207.0, -1807.5, 3.50},
{ 304.1, -1852.1, 2.27},
{ 175.0, -1804.1, 3.12},
{298.1, -1861.8, 1.98},
{212.1, -1808.8, 3.52},
{228.3, -1722.5, 3.59},
{197.5, -1876.2, 1.27},
{ 224.4, -1806.4, 3.49},
{ 221.0, -1754.5, 3.61},
{ 160.8, -1793.0, 2.90},
{ 254.3, -1845.6, 2.33},
{178.1, -1867.6, 2.03},
{ 284.4, -1868.9, 1.70},
{ 175.7, -1798.9, 3.02},
{ 204.6, -1823.5, 3.14},
{277.8, -1892.5, 0.48},
{ 238.3, -1837.1, 2.59},
{ 260.9, -1841.9, 2.44},
{ 234.6, -1800.9, 3.43},
{207.9, -1797.4, 3.32},
{182.5, -1803.4, 3.17},
{ 264.0, -1772.8, 3.76},
{311.8, -1824.2, 3.06},
{227.0, -1832.2, 2.77},
{233.3, -1838.7, 2.56},
{235.6, -1786.1, 3.27},
{228.6, -1886.3, 0.18},
{219.1, -1781.9, 3.11},
{259.9, -1818.9, 3.09},
{ 216.5, -1782.4, 3.08},
{ 151.4, -1875.4, 2.77},
{226.7, -1798.5, 3.41},
{ 267.8, -1814.8, 3.22},
{279.9, -1819.1, 3.12},
{ 293.3, -1809.0, 3.43},
{212.9, -1786.6, 3.13},
{ 221.7, -1835.1, 2.71},
{222.3, -1829.1, 2.88},
{ 243.8, -1769.9, 3.44},
{ 250.9, -1828.9, 2.80},
{293.5, -1790.6, 3.42},
{ 281.5, -1825.2, 2.96},
{ 232.8, -1794.6, 3.37},
{ 268.5, -1879.5, 1.11},
{ 201.7, -1802.8, 3.35},
{229.0, -1814.0, 3.29},
{152.8, -1872.3, 2.77},
{ 222.3, -1860.3, 2.04},
{ 210.8, -1850.4, 2.34},
{198.1, -1790.1, 2.98},
{241.4, -1790.9, 3.32},
{215.3, -1872.5, 1.44},
{194.5, -1795.6, 3.09},
{ 215.7, -1807.9, 3.51},
{227.6, -1822.6, 3.05},
{ 262.2, -1829.8, 2.78},
{ 151.6, -1833.9, 2.76},
{186.3, -1813.4, 3.40},
{ 200.1, -1766.0, 3.30},
{ 173.7, -1809.5, 3.25},
{ 222.9, -1772.4, 3.54},
{ 152.5, -1795.5, 2.84},
{ 161.3, -1880.6, 2.77},
{ 171.3, -1830.7, 3.00},
{ 204.3, -1822.4, 3.17},
{247.4, -1738.5, 3.22},
{ 199.1, -1855.3, 2.28},
{188.4, -1856.8, 2.28},
{ 266.0, -1809.4, 3.38},
{ 262.5, -1878.6, 0.93},
{ 284.8, -1814.4, 3.26},
{311.0, -1869.4, 1.80},
{ 239.8, -1820.4, 3.07},
{323.9, -1803.8, 3.59},
{231.4, -1821.0, 3.07},
{ 222.6, -1814.0, 3.33},
{158.4, -1774.0, 3.37},
{221.1, -1811.4, 3.41},
{ 214.5, -1871.4, 1.55},
{ 238.5, -1828.7, 2.83},
{ 305.0, -1874.9, 1.52},
{ 219.7, -1831.4, 2.83},
{291.4, -1861.1, 1.98},
{ 215.8, -1852.2, 2.27},
{235.1, -1804.7, 3.47},
{254.9, -1875.0, 0.97},
{ 224.9, -1756.4, 3.73},
{235.0, -1782.8, 3.24},
{ 301.3, -1760.3, 3.55},
{ 250.1, -1824.9, 2.92},
{213.9, -1756.4, 3.48},
{ 193.1, -1782.5, 2.72},
{ 249.9, -1819.6, 3.07},
{278.7, -1830.2, 2.82},
{300.7, -1771.6, 3.53},
{186.5, -1811.7, 3.43},
{ 166.5, -1839.1, 2.82},
{226.6, -1809.5, 3.44},
{225.8, -1808.4, 3.47},
{174.9, -1795.5, 3.04},
{289.0, -1853.4, 2.20},
{229.5, -1732.5, 3.15},
{232.9, -1810.8, 3.37},
{ 245.8, -1767.5, 3.75},
{217.7, -1815.1, 3.32},
{ 146.0, -1820.1, 0.14},
{ 243.6, -1835.1, 2.64},
{226.9, -1836.3, 2.65},
{ 170.4, -1793.4, 3.13},
{227.9, -1823.6, 3.02},
{ 226.1, -1834.3, 2.71},
{291.6, -1854.8, 2.15},
{237.4, -1774.1, 3.19},
{ 254.1, -1857.8, 2.02},
{204.0, -1841.2, 2.62},
{212.4, -1846.7, 2.43},
{256.6, -1823.0, 2.97},
{ 229.2, -1800.9, 3.44},
{ 262.9, -1820.9, 3.04},
{ 216.3, -1815.9, 3.30},
{ 241.9, -1819.8, 3.08},
{203.5, -1839.4, 2.69},
{ 219.9, -1827.0, 2.96},
{ 226.3, -1739.4, 3.37},
{ 175.4, -1802.8, 3.09},
{193.1, -1853.0, 2.36},
{ 198.0, -1829.0, 3.00},
{226.2, -1828.3, 2.89},
{148.1, -1814.0, 2.74},
{191.5, -1824.2, 3.17},
{ 188.0, -1830.8, 2.99},
{ 300.6, -1875.9, 1.44},
{ 222.9, -1812.7, 3.36},
{199.9, -1777.4, 2.67},
{240.9, -1816.8, 3.17},
{137.0, -1780.0, 2.75},
{ 241.9, -1819.2, 3.10},
{314.0, -1841.4, 2.57},
{172.7, -1860.4, 2.24},
{ 290.0, -1765.2, 3.55},
{ 199.2, -1826.5, 3.07},
{ 309.1, -1872.4, 1.64},
{ 269.6, -1788.0, 3.34},
{ 208.3, -1807.3, 3.50},
{311.1, -1853.3, 2.25},
{ 214.4, -1821.5, 3.15},
{ 186.7, -1811.0, 3.41},

--sza czesc plazy
{ 496.1, -1893.5, 0.90},
{444.9, -1873.5, 3.37},
{ 502.2, -1845.3, 3.55},
{ 466.0, -1834.9, 3.80},
{517.9, -1841.8, 3.85},
{ 508.1, -1901.1, 0.22},
{497.8, -1844.8, 3.53},
{ 462.3, -1854.1, 2.59},
{ 509.0, -1859.8, 2.84},
{ 511.3, -1892.9, 0.96},
{514.1, -1865.0, 2.81},
{ 519.4, -1874.6, 2.66},
{ 479.8, -1864.3, 2.44},
{502.4, -1896.8, 0.69},
{520.2, -1854.2, 3.30},
{481.4, -1878.7, 2.06},
{518.5, -1869.2, 2.79},
{510.1, -1851.0, 3.22},
{596.4, -1867.4, 3.66},
{ 465.9, -1892.8, 0.08},
{ 470.8, -1865.9, 2.34},
{ 507.6, -1875.1, 2.41},
{ 491.1, -1891.7, 1.00},
{526.6, -1890.1, 2.17},
{512.9, -1864.5, 2.80},
{ 497.2, -1867.5, 2.46},
{ 556.0, -1888.3, 2.53},
{ 524.2, -1853.7, 3.42},
{475.6, -1836.0, 3.93},
{475.0, -1865.9, 2.36},
{417.6, -1870.7, 2.13},
{ 522.7, -1878.5, 2.57},
{522.1, -1877.6, 2.59},
{503.6, -1850.3, 3.20},
{ 490.5, -1852.2, 2.92},
{518.2, -1854.6, 3.24},
{525.1, -1871.1, 2.87},
{466.3, -1845.7, 3.06},
{485.6, -1842.5, 3.54},
{511.1, -1845.9, 3.51},
{510.5, -1851.3, 3.21},
{529.6, -1849.8, 3.69},
{ 490.8, -1888.3, 1.33},
{508.6, -1893.1, 0.97},
{434.8, -1878.0, 1.71},
{596.1, -1861.0, 3.91},
{476.7, -1838.1, 3.79},
{ 496.8, -1858.6, 2.70},
{ 498.0, -1876.1, 2.24},
{ 434.4, -1867.8, 2.10},
{479.6, -1863.8, 2.45},
{468.4, -1868.1, 2.25},
{470.9, -1883.3, 1.37},
{ 595.4, -1877.8, 3.23},

{584.8, -1843.7, 4.46},
{617.6, -1883.0, 3.01},
{542.4, -1862.7, 3.40},
{ 584.5, -1854.8, 4.00},
{622.8, -1853.1, 4.45},
{ 574.9, -1882.1, 2.91},
{624.1, -1868.7, 3.78},
{689.6, -1877.0, 3.56},
{ 677.9, -1905.9, 1.96},
{618.5, -1890.0, 2.68},
{613.0, -1877.2, 3.28},
{ 586.0, -1908.6, 0.74},
{646.3, -1868.5, 3.95},
{660.0, -1903.3, 2.21},
{ 620.6, -1859.8, 4.18},
{596.2, -1882.2, 3.06},
{596.2, -1861.0, 3.91},
{653.6, -1859.7, 4.46},
{539.8, -1875.7, 2.88},
{644.7, -1902.7, 2.20},
{607.5, -1900.6, 2.30},
{596.9, -1886.3, 2.90},
{ 627.9, -1877.6, 3.36},
{ 623.5, -1880.7, 3.17},
{ 558.2, -1842.5, 4.26},
{ 522.8, -1888.7, 2.17},
{687.8, -1908.9, 1.71},
{664.9, -1901.9, 2.25},
{ 628.8, -1853.2, 4.45},
{ 592.8, -1839.4, 4.63},
{616.4, -1852.1, 4.63},
{ 608.2, -1862.9, 3.95},
{ 633.2, -1893.6, 2.58},
{547.0, -1903.1, 0.88},
{606.0, -1897.0, 2.45},
{ 541.8, -1832.5, 4.46},
{603.0, -1871.5, 3.50},
{615.0, -1877.8, 3.26},
{599.9, -1908.5, 1.04},
{629.9, -1875.1, 3.50},
{ 630.3, -1874.5, 3.54},
{ 569.6, -1861.7, 3.55},
{631.2, -1865.0, 4.02},
{608.5, -1871.8, 4.77},
{640.9, -1882.2, 3.21},
{625.1, -1871.5, 3.65},
}

local smieci={ 928, 924, 926}
for i,v in ipairs(polozenia) do
    if (math.random(1,4)==1) then
	local oid=smieci[math.random(1,#smieci)]
        v.obiekt=createObject(oid, v[1], v[2],v[3]+0.2)
        setElementDoubleSided(v.obiekt,true)
	setElementData(v.obiekt,"customAction",{label="Podnieś",resource="lss-smieci",funkcja="menu_podniesSmiecia",args={obiekt=v.obiekt}})
    end
end

local function countTrash()
    local cnt=0
    for i,v in ipairs(polozenia) do
	if (v.obiekt and isElement(v.obiekt)) then
	    cnt=cnt+1
	end
    end
    return cnt
end

local function over150() -- olac ladne nazwy, ma dzialac szybko
    local cnt=0
    for i,v in ipairs(polozenia) do
	if (v.obiekt and isElement(v.obiekt)) then
	    cnt=cnt+1
	    if (cnt>150) then return true end
	end
    end
    return cnt>150 and true or false

end




function trashPickup(obiekt)
	if (not isElement(obiekt)) then
	  return
	end  
    if (not exports["lss-core"]:eq_giveItem(source,9,1)) then return end	-- gracz nie ma miejsca w eq

    destroyElement(obiekt)
    triggerEvent("broadcastCaptionedEvent", source, getPlayerName(source) .. " podnosi coś z ziemi.", 5, 15, true)
end
addEvent("onTrashPickup", true)
addEventHandler("onTrashPickup", root, trashPickup)

function regenTrash()
--    outputDebugString("ilosc smieci: " .. countTrash())
    if (over150()) then return end
    outputDebugString("Ilosc smieci spadla ponizej 150, regenerowanie...")

    for i,v in ipairs(polozenia) do
	if (not v.obiekt or not isElement(v.obiekt) and math.random(1,4)==1) then
		local oid=smieci[math.random(1,#smieci)]
	        v.obiekt=createObject(oid, v[1], v[2],v[3]+0.2)
	        setElementDoubleSided(v.obiekt,true)
		setElementData(v.obiekt,"customAction",{label="Podnieś",resource="lss-smieci",funkcja="menu_podniesSmiecia",args={obiekt=v.obiekt}})
        end
    end
    outputDebugString("Regeneracja smieci zakonczona.")
end

setTimer(regenTrash, 60000, 0)